<html>

<script id="vertex-shader" type="x-shader/x-vertex">

attribute vec3 vPosition;
attribute vec3 vNormal;
uniform mat4 projection;
uniform mat4 modelView;
uniform mat4 modelT;


varying vec3 N, pos;

void main()
{
    pos = (modelT * vec4(vPosition, 1.0)).xyz;
    N = normalize( modelT*vec4(vNormal, 0.0)).xyz;
    gl_Position = projection * modelView * modelT * vec4(vPosition,1.0);
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">

precision mediump float;

uniform vec4 ambientProduct;
uniform vec4 diffuseProduct;
uniform vec4 specularProduct;
uniform float shininess;
varying vec3 N, pos;
uniform vec4 lightPosition;
uniform vec4 eyePosition;

void
main()
{
    vec4 color;

    vec3 L = normalize( lightPosition.xyz - pos );
    vec3 E = normalize(eyePosition.xyz - pos);
    vec3 H = normalize( L + E );

    vec4 ambient = ambientProduct;

    float Kd = max( dot(L, N), 0.0 );
    vec4  diffuse = Kd*diffuseProduct;

    float Ks = pow( max(dot(N, H), 0.0), shininess );
    vec4  specular = Ks * specularProduct;

    if( dot(L, N) < 0.0 ) specular = vec4(0.0, 0.0, 0.0, 1.0);

    color = ambient + diffuse + specular;
    color.a = 1.0;

    gl_FragColor = ambient;

    gl_FragColor = vec4(vec3(   dot(L, N)+1.0   ),1.0);

    gl_FragColor = color;
}
</script>

<script type="text/javascript" src="./Common/webgl-utils.js"></script>
<script type="text/javascript" src="./Common/initShaders.js"></script>
<script type="text/javascript" src="./Common/MV.js"></script>
<script type="text/javascript" src="v1.js"></script>
<body>


    <canvas id="gl-canvas" width="576" height="1024" style="
    padding: 0;
    margin: auto;
    display: block;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;">
        Oops ... your browser doesn't support the HTML5 canvas element
    </canvas>

    <br>
    light position
    <br>
    x<input id="x" type="number" value="0.0" step ="0.1" style="width: 60px;"/>
    y<input id="y" type="number" value="2.0" step ="0.1" style="width: 60px;"/>
    z<input id="z" type="number" value="3.0" step ="0.1" style="width: 60px;"/>
    <br> freeView <input id="freeView" type="checkbox"/>
    <br>keys = wasd


</body>

</html>
